# AliveAgain - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ Supabase Backend

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
1. [–ß—Ç–æ —Ç–∞–∫–æ–µ Supabase](#—á—Ç–æ-—Ç–∞–∫–æ–µ-supabase)
2. [–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞](#—Å–æ–∑–¥–∞–Ω–∏–µ-–ø—Ä–æ–µ–∫—Ç–∞)
3. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–±–∞–∑—ã-–¥–∞–Ω–Ω—ã—Ö)
4. [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥](#–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-—Å-—Ñ—Ä–æ–Ω—Ç–µ–Ω–¥)
5. [–ü—Ä–∏–º–µ—Ä—ã API –∑–∞–ø—Ä–æ—Å–æ–≤](#–ø—Ä–∏–º–µ—Ä—ã-api-–∑–∞–ø—Ä–æ—Å–æ–≤)
6. [–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ](#—Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ)

---

## –ß—Ç–æ —Ç–∞–∫–æ–µ Supabase

**Supabase** - —ç—Ç–æ –æ—Ç–∫—Ä—ã—Ç–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ Firebase, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç:
- üóÑÔ∏è PostgreSQL –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
- üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- üì° Real-time API
- üíæ –•—Ä–∞–Ω–∏–ª–∏—â–µ —Ñ–∞–π–ª–æ–≤
- üîî Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

–ò–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –Ω–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ AliveAgain!

---

## –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

### –®–∞–≥ 1: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ Supabase
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [https://supabase.com](https://supabase.com)
2. –ù–∞–∂–º–∏—Ç–µ "Sign Up" (–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è)
3. –°–æ–∑–¥–∞–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç —á–µ—Ä–µ–∑ GitHub –∏–ª–∏ Email
4. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ email

### –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
1. –í –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞–∂–º–∏—Ç–µ "New Project"
2. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ:
   - **Project Name**: `AliveAgain`
   - **Database Password**: –ü—Ä–∏–¥—É–º–∞–π—Ç–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø–∞—Ä–æ–ª—å
   - **Region**: –í—ã–±–µ—Ä–∏—Ç–µ –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ –±–ª–∏–∑–∫–∏–π —Ä–µ–≥–∏–æ–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, Europe West)
3. –ù–∞–∂–º–∏—Ç–µ "Create new project"
4. –î–æ–∂–¥–∏—Ç–µ—Å—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ (5-10 –º–∏–Ω—É—Ç)

### –®–∞–≥ 3: –ü–æ–ª—É—á–µ–Ω–∏–µ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤:
- **Settings** ‚Üí **API**

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ:
- `Project URL` - URL –≤–∞—à–µ–≥–æ Supabase –ø—Ä–æ–µ–∫—Ç–∞
- `anon public` - –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞
- `service_role` - —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á (—Ç–æ–ª—å–∫–æ –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞)

---

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞: users (–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏)
```sql
CREATE TABLE users (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  email VARCHAR(255) NOT NULL UNIQUE,
  username VARCHAR(100) NOT NULL,
  full_name VARCHAR(255),
  avatar_url TEXT,
  bio TEXT,
  age INT,
  country VARCHAR(100),
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);
```

### –¢–∞–±–ª–∏—Ü–∞: visits (–ü–æ—Å–µ—â–µ–Ω–∏—è)
```sql
CREATE TABLE visits (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
  country VARCHAR(100) NOT NULL,
  visited_at TIMESTAMP DEFAULT NOW(),
  duration_minutes INT,
  impressions TEXT
);
```

### –¢–∞–±–ª–∏—Ü–∞: friends (–î—Ä—É–∑—å—è)
```sql
CREATE TABLE friends (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
  friend_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
  status VARCHAR(50) DEFAULT 'pending', -- pending, accepted, blocked
  created_at TIMESTAMP DEFAULT NOW(),
  UNIQUE(user_id, friend_id)
);
```

### –¢–∞–±–ª–∏—Ü–∞: messages (–°–æ–æ–±—â–µ–Ω–∏—è)
```sql
CREATE TABLE messages (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  sender_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
  recipient_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
  content TEXT NOT NULL,
  created_at TIMESTAMP DEFAULT NOW(),
  is_read BOOLEAN DEFAULT FALSE
);
```

### –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –≤ Supabase:
1. –û—Ç–∫—Ä–æ–π—Ç–µ **SQL Editor** –≤ –ª–µ–≤–æ–π –ø–∞–Ω–µ–ª–∏
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ SQL –∫–æ–¥ –≤—ã—à–µ
3. –ù–∞–∂–º–∏—Ç–µ "Run" –¥–ª—è –∫–∞–∂–¥–æ–π —Ç–∞–±–ª–∏—Ü—ã

---

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥

### –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Supabase –∫–ª–∏–µ–Ω—Ç–∞
```bash
npm install @supabase/supabase-js
```

### –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `supabase-config.js`:

```javascript
import { createClient } from '@supabase/supabase-js'

const SUPABASE_URL = 'https://your-project.supabase.co'
const SUPABASE_ANON_KEY = 'your-anon-key-here'

export const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY)
```

**‚ö†Ô∏è –í–ê–ñ–ù–û**: –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–µ –∫–ª—é—á–∏ –≤ Git! –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `.env` —Ñ–∞–π–ª—ã.

### –®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ `.env.local`
```
VITE_SUPABASE_URL=https://your-project.supabase.co
VITE_SUPABASE_ANON_KEY=your-anon-key-here
```

### –®–∞–≥ 4: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–∞ –¥–ª—è Vite
```javascript
import { defineConfig } from 'vite'

export default defineConfig({
  define: {
    'process.env': process.env
  }
})
```

---

## –ü—Ä–∏–º–µ—Ä—ã API –∑–∞–ø—Ä–æ—Å–æ–≤

### 1. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
```javascript
import { supabase } from './supabase-config.js'

async function signUp(email, password, username) {
  try {
    const { data, error } = await supabase.auth.signUp({
      email: email,
      password: password,
    })
    
    if (error) throw error
    
    // –°–æ–∑–¥–∞–µ–º –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    const { error: profileError } = await supabase
      .from('users')
      .insert([
        { id: data.user.id, email: email, username: username }
      ])
    
    if (profileError) throw profileError
    
    return { success: true, user: data.user }
  } catch (error) {
    return { success: false, error: error.message }
  }
}
```

### 2. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è - –í—Ö–æ–¥
```javascript
async function signIn(email, password) {
  try {
    const { data, error } = await supabase.auth.signInWithPassword({
      email: email,
      password: password,
    })
    
    if (error) throw error
    return { success: true, session: data.session }
  } catch (error) {
    return { success: false, error: error.message }
  }
}
```

### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```javascript
async function getUserProfile(userId) {
  try {
    const { data, error } = await supabase
      .from('users')
      .select('*')
      .eq('id', userId)
      .single()
    
    if (error) throw error
    return { success: true, profile: data }
  } catch (error) {
    return { success: false, error: error.message }
  }
}
```

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
```javascript
async function updateUserProfile(userId, updates) {
  try {
    const { data, error } = await supabase
      .from('users')
      .update(updates)
      .eq('id', userId)
      .select()
    
    if (error) throw error
    return { success: true, profile: data[0] }
  } catch (error) {
    return { success: false, error: error.message }
  }
}
```

### 5. –ó–∞–ø–∏—Å–∞—Ç—å –ø–æ—Å–µ—â–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω—ã
```javascript
async function recordVisit(userId, country, duration) {
  try {
    const { data, error } = await supabase
      .from('visits')
      .insert([
        { 
          user_id: userId, 
          country: country,
          duration_minutes: duration
        }
      ])
      .select()
    
    if (error) throw error
    return { success: true, visit: data[0] }
  } catch (error) {
    return { success: false, error: error.message }
  }
}
```

### 6. –ü–æ–ª—É—á–∏—Ç—å –¥—Ä—É–∑–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```javascript
async function getUserFriends(userId) {
  try {
    const { data, error } = await supabase
      .from('friends')
      .select('friend_id, friends(username, avatar_url)')
      .eq('user_id', userId)
      .eq('status', 'accepted')
    
    if (error) throw error
    return { success: true, friends: data }
  } catch (error) {
    return { success: false, error: error.message }
  }
}
```

### 7. –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
```javascript
async function sendMessage(senderId, recipientId, content) {
  try {
    const { data, error } = await supabase
      .from('messages')
      .insert([
        {
          sender_id: senderId,
          recipient_id: recipientId,
          content: content
        }
      ])
      .select()
    
    if (error) throw error
    return { success: true, message: data[0] }
  } catch (error) {
    return { success: false, error: error.message }
  }
}
```

### 8. –ü–æ–ª—É—á–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ (Real-time)
```javascript
async function subscribeToMessages(userId) {
  const subscription = supabase
    .from(`messages:recipient_id=eq.${userId}`)
    .on('*', payload => {
      console.log('–ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:', payload.new)
      // –û–±–Ω–æ–≤–ª—è–µ–º UI
    })
    .subscribe()
  
  return subscription
}
```

---

## –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ Vercel
```bash
# 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git init
git add .
git commit -m "Initial commit"

# 2. –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞ GitHub
git remote add origin https://github.com/–≤–∞—à–µ-–∏–º—è/AliveAgain.git
git push -u origin main

# 3. –ù–∞ Vercel –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
# https://vercel.com/import

# 4. –î–æ–±–∞–≤–ª—è–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
# VITE_SUPABASE_URL
# VITE_SUPABASE_ANON_KEY
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ Netlify
```bash
# 1. –£—Å—Ç–∞–Ω–æ–≤–∏–º Netlify CLI
npm install -g netlify-cli

# 2. –õ–æ–≥–∏—Ä—É–µ–º—Å—è
netlify login

# 3. –î–µ–ø–ª–æ–∏–º –ø—Ä–æ–µ–∫—Ç
netlify deploy --prod
```

---

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### Row Level Security (RLS) - –ó–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö
```sql
-- –¢–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤–∏–¥–µ—Ç—å —Å–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å
CREATE POLICY "Users can view own profile"
ON users
FOR SELECT
USING (auth.uid() = id);

-- –¢–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å —Å–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å
CREATE POLICY "Users can update own profile"
ON users
FOR UPDATE
USING (auth.uid() = id);

-- –¢–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª–µ—Ü –º–æ–∂–µ—Ç –≤–∏–¥–µ—Ç—å —Å–≤–æ–∏ —Å–æ–æ–±—â–µ–Ω–∏—è
CREATE POLICY "Users can view own messages"
ON messages
FOR SELECT
USING (auth.uid() = sender_id OR auth.uid() = recipient_id);
```

### –í–∫–ª—é—á–µ–Ω–∏–µ RLS
1. –í **SQL Editor** –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—ã –≤—ã—à–µ
2. –í —Ç–∞–±–ª–∏—Ü–µ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **Auth**
3. –í–∫–ª—é—á–∏—Ç–µ "Enable RLS"

---

## –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- üìö [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Supabase](https://supabase.com/docs)
- üîê [Authentication](https://supabase.com/docs/guides/auth)
- üóÑÔ∏è [Database](https://supabase.com/docs/guides/database)
- üöÄ [Realtime](https://supabase.com/docs/guides/realtime)
- üíæ [Storage](https://supabase.com/docs/guides/storage)

---

## –°–æ–≤–µ—Ç—ã –ø–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

‚úÖ **DO:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –∫–ª—é—á–µ–π
- –í–∫–ª—é—á–∏—Ç–µ Row Level Security –¥–ª—è –∑–∞—â–∏—Ç—ã –¥–∞–Ω–Ω—ã—Ö
- –°–æ–∑–¥–∞–≤–∞–π—Ç–µ –∏–Ω–¥–µ–∫—Å—ã –Ω–∞ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–æ–ª–æ–Ω–∫–∏
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Real-time –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

‚ùå **DON'T:**
- –ù–µ –∫–æ–º–º–∏—Ç—å—Ç–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª—é—á–∏
- –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ service_role –∫–ª—é—á –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
- –ù–µ –æ–±—Ö–æ–¥–∏—Ç–µ RLS –ø–æ–ª–∏—Ç–∏–∫–∏
- –ù–µ –¥–æ–≤–µ—Ä—è–π—Ç–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ç–æ–ª—å–∫–æ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ

---

## –í–æ–ø—Ä–æ—Å—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é Supabase](https://supabase.com/docs)
2. –ü–æ—Å–µ—Ç–∏—Ç–µ [Community Forum](https://github.com/supabase/supabase/discussions)
3. –û—Ç–∫—Ä–æ–π—Ç–µ issue –Ω–∞ [GitHub](https://github.com/supabase/supabase/issues)

---

**AliveAgain ¬© 2026** | Powered by Supabase
